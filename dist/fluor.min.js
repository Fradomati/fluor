const n={append:"push",prepend:"unshift",pop:"pop",shift:"shift"};function t(n,t=document){return n instanceof Node?[n]:t.querySelectorAll(n)}function o(n,t=document){return n instanceof Node?n:t.querySelector(n)}function e(){return Math.random().toString(36).slice(2)}function c(n){return Array.isArray(n)?n.join(" "):"string"==typeof n?n:Object.entries(n).reduce((n,[t,o])=>o?n.concat(t):n,[])}function r(n,t){return n.split(".").reduce((n,t)=>n[t],t)}function f(n,t,o){return e=n,Boolean(e&&e.constructor&&e.call&&e.apply)?n(t,o):n;var e}function s(n,t){const o=[n];for(;o.length;){const n=o.shift();!1!==t(n)&&Array.from(n.children,n=>o.push(n))}}function u(n){if(!h.t.size)return null;let t=n;for(;t;){if(h.t.has(t))return h.t.get(t);t=t.parentElement}return null}function i(n,t,o){const[c,f]=n.value.split(/\s+in\s+/),s=r(f,o),u=document.createDocumentFragment();if(t.o){const e=[...new Set(t.o.map(n=>n.molecule))];for(const n of e)l(n),n.$root.parentElement.removeChild(n.$root);t.o=null,i(n,t,o)}else{t.o=[];for(let n=0,o=s.length;n<o;n++){const o=t.content.cloneNode(!0);for(const e of[...o.children])t.o.push({index:n,child:e}),u.append(e)}t.parentNode.insertBefore(u,t.nextSibling);for(const n of t.o){const{index:t,child:o}=n,r=d(e(),o);r.setup({$index:t,[c]:s[t]}),n.molecule=r,h.t.set(o,r),$(o),r.render()}}}function a(n,t,o){if(!n.name.startsWith("@"))return;const e=r(n.value,o),c=n.name.slice(1);switch(e){case!0:t.setAttribute(c,"");break;case!1:t.removeAttribute(c);break;default:t.setAttribute(c,e)}}function d(e,d){const l={},p=n=>Object.assign(l,n),h=d?u(d.parentElement):null;function $(n=!0){const t=u(d);s(d,o=>{const e=u(o);if(e!==t)return n&&e.render(n),!1;for(const n of o.attributes)switch(n.name){case"@text":o.textContent=r(n.value,l);break;case"@html":o.innerHTML=r(n.value,l);break;case"@each":i(n,o,l);break;default:a(n,o,l)}})}function b(n,t){p("object"==typeof n?Object.entries(n).reduce((n,[t,o])=>({...n,[t]:f(o,l[t],l)}),{}):{[n]:f(t,l[n],l)})}return h&&p({$parent:h.$data}),{set:(n,t)=>()=>{b(n,t),$()},setup(n,t){b(n,t)},on(n,o,e){const c=Array.isArray(e)?n=>e.forEach(t=>t(n)):e;for(const e of t(o,d))u(e).$root===d&&e.addEventListener(n,c)},toggle:(n,t=null)=>e=>{(t?o(t,d):e.currentTarget).classList.toggle(n)},...Object.entries(n).reduce((n,[t,o])=>({...n,[t]:(n,t)=>()=>{l[n][o](f(t,l[n],l)),$()}}),{}),withEvent:n=>t=>n(t)(),render:$,classes:c,$data:l,$id:e,$root:d,$parent:h,$:n=>t(n,d),$$:n=>o(n,d)}}function l(n){const t=h.s.get(n)||[];for(const n of t)n.parentElement.removeChild(n)}const p=Object.keys(d());function h(n,t){t(Array.from(h.t.values()).find(t=>t.$id===n))}function $(n){const t=[],o=[];s(n,n=>{"SCRIPT"===n.tagName&&"fluor"===n.type&&t.push(n)});for(const n of t){const t=n.parentElement;let c;if(h.t.has(t))c=h.t.get(t);else{c=d(e(),t),h.t.set(t,c)}n.u=c,o.push(c)}const c=document.createDocumentFragment();for(const n of t){const t=n.u,o=document.createElement("script"),e=`Fluor("${t.$id}", ({${p.join(",")}}) => {${n.textContent}; render(false)})`;o.textContent=e,n.parentElement.removeChild(n),h.s.has(t)?h.s.set(t,[...h.s.get(t),o]):h.s.set(t,[o]),c.appendChild(o)}document.body.appendChild(c)}window.Fluor=h,h.t=new Map,h.s=new Map,async function(){await new Promise(n=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",n):n()}),$(document.body)}();