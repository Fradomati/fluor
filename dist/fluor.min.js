function n(n,t=document){return n instanceof Node?[n]:t.querySelectorAll(n)}function t(n,t=document){return n instanceof Node?n:t.querySelector(n)}function o(){return document.createDocumentFragment()}function c(...n){return n.map(n=>Array.isArray(n)?n.map(n=>c(...n)).join(" "):"string"==typeof n?n:c(...Object.entries(n).reduce((n,[t,o])=>o?n.concat(t):n,[]))).join(" ")}function e(n,t){return n.split(".").reduce((n,t)=>n[t],t)}function f(n,t,o){return c=n,Boolean(c&&c.constructor&&c.call&&c.apply)?n(t,o):n;var c}function r(n,t){const o=[n];for(;o.length;){const n=o.shift();if(!1!==t(n))for(const t of n.children)o.push(t)}}function s(n){let t=n;for(;t;){if(b.t.has(t))return b.t.get(t);t=t.parentElement}return null}function u(n,t,c){if("TEMPLATE"!==t.tagName)return void 0;const f=e(n.value,c);if(t.o){const n=[...new Set(t.o.map(n=>n.molecule))];for(const t of n)t.$root.parentNode.removeChild(t.$root),p(t);t.o=null}if(f&&!t.o){const n=o(),c=t.content.cloneNode(!0);t.o=[];for(const o of[...c.children])t.o.push({child:o}),n.append(o);t.parentNode.insertBefore(n,t.nextSibling);for(const n of t.o){const{child:t}=n,o=d(t);n.molecule=o,m(t),o.render()}}}function i(n,t,c){if("TEMPLATE"!==t.tagName)return void 0;const[f,r]=n.value.split(/\s+in\s+/),s=e(r,c),u=o();if(t.s){const o=[...new Set(t.s.map(n=>n.molecule))];for(const n of o)n.$root.parentNode.removeChild(n.$root),p(n);t.s=null,i(n,t,c)}else{t.s=[];for(let n=0,o=s.length;n<o;n++){const o=t.content.cloneNode(!0);for(const c of[...o.children])t.s.push({index:n,child:c}),u.append(c)}t.parentNode.insertBefore(u,t.nextSibling);for(const n of t.s){const{index:t,child:o}=n,c=d(o);c.setup({$index:t,[f]:s[t]}),n.molecule=c,m(o),c.render()}}}function a(n,t,o){const[c,f]=n.value.split(":"),r=e(f,o);switch(r){case!0:t.setAttribute(c,"");break;case!1:t.removeAttribute(c);break;default:t.setAttribute(c,r)}}function l(o,l){const d={},p=n=>Object.assign(d,n),h=l?s(l.parentNode):null;function b(n=!0){const t=s(l);r(l,o=>{const c=s(o);if(c!==t)return n&&c.render(n),!1;for(const n of o.attributes)switch(n.name){case"f-text":o.textContent=e(n.value,d);break;case"f-html":o.innerHTML=e(n.value,d);break;case"f-if":u(n,o,d);break;case"f-each":i(n,o,d);break;case"f-bind":a(n,o,d)}})}function m(n,t){p("object"==typeof n?Object.entries(n).reduce((n,[t,o])=>({...n,[t]:f(o,d[t],d)}),{}):{[n]:f(t,d[n],d)})}function $(t,o,c=null){return e=>{(c?n(c,l):[e.currentTarget]).forEach(n=>n.classList[t](o))}}function w(n){return(t,o=null)=>()=>{d[t][n](f(o,d[t],d)),b()}}return h&&p({$parent:h.$data}),{set:(n,t)=>()=>{m(n,t),b()},setup(n,t){m(n,t)},on(t,o,c){const e=Array.isArray(c)?n=>c.forEach(t=>t(n)):c;for(const c of n(o,l))s(c).$root===l&&c.addEventListener(t,e)},addClass:(n,t=null)=>$("add",n,t),removeClass:(n,t=null)=>$("remove",n,t),toggleClass:(n,t=null)=>$("toggle",n,t),append:w("push"),prepend:w("unshift"),pop:w("pop"),shift:w("shift"),withEvent:n=>t=>n(t)(),render:b,classes:c,$data:d,$id:o,$root:l,$parent:h,$:(t,o=l)=>n(t,o),$$:(n,o=l)=>t(n,o),u:[]}}function d(n){const t=l(Math.random().toString(36).slice(2),n);return b.t.set(n,t),t}function p(n){for(const t of n.u)t.parentNode.removeChild(t)}const h=Object.keys(l()).filter(n=>!n.startsWith("__"));function b(n,t){const o=Array.from(b.t.values()).find(t=>t.$id===n);t(o),o.render(!1)}function m(n){const t=[];r(n,n=>{"SCRIPT"===n.tagName&&"fluor"===n.type&&t.push(n)});for(const n of t){const t=n.parentNode,o=b.t.get(t)||d(t);n.i=o}const c=o();for(const n of t){const t=n.i,o=document.createElement("script"),e=`RunFluor("${t.$id}", ({${h.join(",")}}) => {${n.textContent}})`;o.textContent=e,n.parentNode.removeChild(n),t.u.push(o),c.appendChild(o)}document.body.appendChild(c)}window.RunFluor=b,b.t=new Map,async function(){await new Promise(n=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",n):n()}),m(document.body)}();export default function $(n,o){b(d(t(n)).$id,o)}