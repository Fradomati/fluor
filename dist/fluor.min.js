const n={append:"push",prepend:"unshift",pop:"pop",shift:"shift"};function t(n,t=document){return n instanceof Node?[n]:t.querySelectorAll(n)}function o(){return Math.random().toString(36).slice(2)}function e(n){return Array.isArray(n)?n.join(" "):"string"==typeof n?n:Object.entries(n).reduce((n,[t,o])=>o?n.concat(t):n,[])}function c(n,t){return n.split(".").reduce((n,t)=>n[t],t)}function r(n,t,o){return e=n,Boolean(e&&e.constructor&&e.call&&e.apply)?n(t,o):n;var e}function s(n,t){const o=[n];for(;o.length;){const n=o.shift();!1!==t(n)&&Array.from(n.children,n=>o.push(n))}}function f(n){if(!p.t.size)return null;let t=n;for(;t;){if(p.t.has(t))return p.t.get(t);t=t.parentElement}return null}function u(n,t,e){const[r,s]=n.value.split(/\s+in\s+/),f=c(s,e),i=document.createDocumentFragment();if(t.o){const o=[...new Set(t.o.map(n=>n.molecule))];for(const n of o)l(n),n.$root.parentElement.removeChild(n.$root);t.o=null,u(n,t,e)}else{t.o=[];for(let n=0,o=f.length;n<o;n++){const o=t.content.cloneNode(!0);for(const e of[...o.children])t.o.push({index:n,child:e}),i.append(e)}t.parentNode.insertBefore(i,t.nextSibling);for(const n of t.o){const{index:t,child:e}=n,c=a(o(),e);c.setup({$index:t,[r]:f[t]}),n.molecule=c,p.t.set(e,c),m(e),c.render()}}}function i(n,t,o){const[e,r]=n.value.split(":"),s=c(r,o);switch(s){case!0:t.setAttribute(e,"");break;case!1:t.removeAttribute(e);break;default:t.setAttribute(e,s)}}function a(o,a){const l={},d=n=>Object.assign(l,n),p=a?f(a.parentElement):null;function m(n=!0){const t=f(a);s(a,o=>{const e=f(o);if(e!==t)return n&&e.render(n),!1;for(const n of o.attributes)switch(n.name){case"f-text":o.textContent=c(n.value,l);break;case"f-html":o.innerHTML=c(n.value,l);break;case"f-each":u(n,o,l);break;case"f-bind":i(n,o,l)}})}function b(n,t){d("object"==typeof n?Object.entries(n).reduce((n,[t,o])=>({...n,[t]:r(o,l[t],l)}),{}):{[n]:r(t,l[n],l)})}function h(n,o,e=null){return c=>{(e?t(e,a):[c.currentTarget]).forEach(t=>t.classList[n](o))}}return p&&d({$parent:p.$data}),{set:(n,t)=>()=>{b(n,t),m()},setup(n,t){b(n,t)},on(n,o,e){const c=Array.isArray(e)?n=>e.forEach(t=>t(n)):e;for(const e of t(o,a))f(e).$root===a&&e.addEventListener(n,c)},addClass:(n,t=null)=>h("add",n,t),removeClass:(n,t=null)=>h("remove",n,t),toggleClass:(n,t=null)=>h("toggle",n,t),...Object.entries(n).reduce((n,[t,o])=>({...n,[t]:(n,t)=>()=>{l[n][o](r(t,l[n],l)),m()}}),{}),withEvent:n=>t=>n(t)(),render:m,classes:e,$data:l,$id:o,$root:a,$parent:p,$:(n,o=a)=>t(n,o),$$:(n,t=a)=>function(n,t=document){return n instanceof Node?n:t.querySelector(n)}(n,t)}}function l(n){const t=p.s.get(n)||[];for(const n of t)n.parentElement.removeChild(n)}const d=Object.keys(a());function p(n,t){t(Array.from(p.t.values()).find(t=>t.$id===n))}function m(n){const t=[],e=[];s(n,n=>{"SCRIPT"===n.tagName&&"fluor"===n.type&&t.push(n)});for(const n of t){const t=n.parentElement;let c;if(p.t.has(t))c=p.t.get(t);else{c=a(o(),t),p.t.set(t,c)}n.u=c,e.push(c)}const c=document.createDocumentFragment();for(const n of t){const t=n.u,o=document.createElement("script"),e=`Fluor("${t.$id}", ({${d.join(",")}}) => {${n.textContent}; render(false)})`;o.textContent=e,n.parentElement.removeChild(n),p.s.has(t)?p.s.set(t,[...p.s.get(t),o]):p.s.set(t,[o]),c.appendChild(o)}document.body.appendChild(c)}window.Fluor=p,p.t=new Map,p.s=new Map,async function(){await new Promise(n=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",n):n()}),m(document.body)}();