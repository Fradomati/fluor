function n(n,o=document){return n instanceof Node?[n]:o.querySelectorAll(n)}function o(n,o=document){return n instanceof Node?n:o.querySelector(n)}function t(){return Math.random().toString(36).slice(2)}function e(...n){return n.map(n=>Array.isArray(n)?n.map(n=>e(...n)).join(" "):"string"==typeof n?n:e(...Object.entries(n).reduce((n,[o,t])=>t?n.concat(o):n,[]))).join(" ")}function c(n,o){return n.split(".").reduce((n,o)=>n[o],o)}function f(n,o,t){return e=n,Boolean(e&&e.constructor&&e.call&&e.apply)?n(o,t):n;var e}function r(n,o){const t=[n];for(;t.length;){const n=t.shift();if(!1!==o(n))for(const o of n.children)t.push(o)}}function s(n){let o=n;for(;o;){if(h.o.has(o))return h.o.get(o);o=o.parentElement}return null}function u(n,o,e){if("TEMPLATE"!==o.tagName)return void 0;const f=c(n.value,e);if(o.t){const n=[...new Set(o.t.map(n=>n.molecule))];for(const o of n)o.$root.parentElement.removeChild(o.$root),d(o);o.t=null}if(f&&!o.t){const n=document.createDocumentFragment(),e=o.content.cloneNode(!0);o.t=[];for(const t of[...e.children])o.t.push({child:t}),n.append(t);o.parentNode.insertBefore(n,o.nextSibling);for(const n of o.t){const{child:o}=n,e=l(t(),o);n.molecule=e,h.o.set(o,e),m(o),e.render()}}}function i(n,o,e){if("TEMPLATE"!==o.tagName)return void 0;const[f,r]=n.value.split(/\s+in\s+/),s=c(r,e),u=document.createDocumentFragment();if(o.s){const t=[...new Set(o.s.map(n=>n.molecule))];for(const n of t)n.$root.parentElement.removeChild(n.$root),d(n);o.s=null,i(n,o,e)}else{o.s=[];for(let n=0,t=s.length;n<t;n++){const t=o.content.cloneNode(!0);for(const e of[...t.children])o.s.push({index:n,child:e}),u.append(e)}o.parentNode.insertBefore(u,o.nextSibling);for(const n of o.s){const{index:o,child:e}=n,c=l(t(),e);c.setup({$index:o,[f]:s[o]}),n.molecule=c,h.o.set(e,c),m(e),c.render()}}}function a(n,o,t){const[e,f]=n.value.split(":"),r=c(f,t);switch(r){case!0:o.setAttribute(e,"");break;case!1:o.removeAttribute(e);break;default:o.setAttribute(e,r)}}function l(t,l){const d={},p=n=>Object.assign(d,n),h=l?s(l.parentElement):null;function m(n=!0){const o=s(l);r(l,t=>{const e=s(t);if(e!==o)return n&&e.render(n),!1;for(const n of t.attributes)switch(n.name){case"f-text":t.textContent=c(n.value,d);break;case"f-html":t.innerHTML=c(n.value,d);break;case"f-if":u(n,t,d);break;case"f-each":i(n,t,d);break;case"f-bind":a(n,t,d)}})}function b(n,o){p("object"==typeof n?Object.entries(n).reduce((n,[o,t])=>({...n,[o]:f(t,d[o],d)}),{}):{[n]:f(o,d[n],d)})}function $(o,t,e=null){return c=>{(e?n(e,l):[c.currentTarget]).forEach(n=>n.classList[o](t))}}function w(n){return(o,t=null)=>()=>{d[o][n](f(t,d[o],d)),m()}}return h&&p({$parent:h.$data}),{set:(n,o)=>()=>{b(n,o),m()},setup(n,o){b(n,o)},on(o,t,e){const c=Array.isArray(e)?n=>e.forEach(o=>o(n)):e;for(const e of n(t,l))s(e).$root===l&&e.addEventListener(o,c)},addClass:(n,o=null)=>$("add",n,o),removeClass:(n,o=null)=>$("remove",n,o),toggleClass:(n,o=null)=>$("toggle",n,o),append:w("push"),prepend:w("unshift"),pop:w("pop"),shift:w("shift"),withEvent:n=>o=>n(o)(),render:m,classes:e,$data:d,$id:t,$root:l,$parent:h,$:(o,t=l)=>n(o,t),$$:(n,t=l)=>o(n,t)}}function d(n){const o=h.u.get(n)||[];for(const n of o)n.parentElement.removeChild(n)}const p=Object.keys(l());function h(n,o){const t=Array.from(h.o.values()).find(o=>o.$id===n);o(t),t.render(!1)}function m(n){const o=[],e=[];r(n,n=>{"SCRIPT"===n.tagName&&"fluor"===n.type&&o.push(n)});for(const n of o){const o=n.parentElement;let c;if(h.o.has(o))c=h.o.get(o);else{c=l(t(),o),h.o.set(o,c)}n.i=c,e.push(c)}const c=document.createDocumentFragment();for(const n of o){const o=n.i,t=document.createElement("script"),e=`RunFluor("${o.$id}", ({${p.join(",")}}) => {${n.textContent}})`;t.textContent=e,n.parentElement.removeChild(n),h.u.set(o,[...h.u.get(o)||[],t]),c.appendChild(t)}document.body.appendChild(c)}window.RunFluor=h,h.o=new Map,h.u=new Map,async function(){await new Promise(n=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",n):n()}),m(document.body)}();export default function b(n,e){const c=o(n),f=t(),r=l(f,c);h.o.set(c,r),h(f,e)}